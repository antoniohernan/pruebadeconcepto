
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Un informático de siempre… en estos tiempos modernos">
      
      
      
        <link rel="canonical" href="https://pruebadeconcepto.es/rpi_apendice2/">
      
      
        <link rel="prev" href="../rpi_apendice1/">
      
      
        <link rel="next" href="../rpi_apendice3/">
      
      <link rel="icon" href="../images/favicon.ico">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.1.4">
    
    
      
        <title>Instalando una RaspberryPI todo uso… en 2014 (parte 16) – Apéndice II - Prueba de Concepto</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.240905d7.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.a0c5b2b5.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent="">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#xbmc-con-mariadb-para-instalacion-distribuida" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Prueba de Concepto" class="md-header__button md-logo" aria-label="Prueba de Concepto" data-md-component="logo">
      
  <img src="../images/logo_white.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Prueba de Concepto
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Instalando una RaspberryPI todo uso… en 2014 (parte 16) – Apéndice II
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_3" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9h-1.9M20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69m-9.15 3.96h2.3L12 9l-1.15 3.65Z"/></svg>
            </label>
          
        
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
            </label>
          
        
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_3">
          
            <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href=".." class="md-tabs__link">
      Inicio
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../gen_hello-world/" class="md-tabs__link">
        Generales
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../infov/infv_guybrush/" class="md-tabs__link">
        Informática Viejuna
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../tec/tec_actionsec2/" class="md-tabs__link">
        Tecnología
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../rpi/rpi_intro/" class="md-tabs__link md-tabs__link--active">
        RaspberryPi
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../about/about_acercademi/" class="md-tabs__link">
        Acerca de
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Prueba de Concepto" class="md-nav__button md-logo" aria-label="Prueba de Concepto" data-md-component="logo">
      
  <img src="../images/logo_white.png" alt="logo">

    </a>
    Prueba de Concepto
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Inicio
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
      
      
      
        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          Generales
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Generales
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../gen_hello-world/" class="md-nav__link">
        Hola mundo!!
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
      
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          Informática Viejuna
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Informática Viejuna
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../infov/infv_guybrush/" class="md-nav__link">
        ¡Hola! Me llamo Guybrush Threepwood, ¡y quiero ser un pirata!
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../infov/infv_discossd/" class="md-nav__link">
        ¿Y esto tiene discos SSD?
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
      
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          Tecnología
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Tecnología
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tec/tec_actionsec2/" class="md-nav__link">
        Envía ficheros desde Github a EC2 con actions
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
      
      
      
        <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
          RaspberryPi
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          RaspberryPi
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../rpi/rpi_intro/" class="md-nav__link">
        Introducción
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../rpi_install_i/" class="md-nav__link">
        Instalación Básica I
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../rpi_install_ii/" class="md-nav__link">
        Instalación Básica II
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../rpi_securizacion/" class="md-nav__link">
        Securización
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../rpi_backup/" class="md-nav__link">
        Copias de Seguridad
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../rpi_wordpress1/" class="md-nav__link">
        Práctico 1 - Wordpress 1
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../rpi_wordpress2/" class="md-nav__link">
        Práctico 1 - Wordpress 2
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../rpi_downmanager/" class="md-nav__link">
        Práctico 2 - Gestor de Descargas
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../rpi_airprint.md" class="md-nav__link">
        Práctico 3 - Servidor Impresión/AirPrint
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../rpi_backupserver/" class="md-nav__link">
        Práctico 4 - Servidor Copias de Seguridad
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../rpi_domotica/" class="md-nav__link">
        Práctico 5 - Domótica, Cámaras IP y RaZberry
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../rpi_mediacenter/" class="md-nav__link">
        Práctico 6 - Media Center
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../rpi_emulador/" class="md-nav__link">
        Práctico 7 - Emulación de juegos
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../rpi/rpi_alternativas/" class="md-nav__link">
        Alternativas a RPi
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../rpi_apendice1/" class="md-nav__link">
        Apéndices (I) - Reinicio de router
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Apéndices (II) - XBMC con MariaDB para BBDD distribuida
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Apéndices (II) - XBMC con MariaDB para BBDD distribuida
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#xbmc-con-mariadb-para-instalacion-distribuida" class="md-nav__link">
    XBMC con MariaDB para instalación distribuida
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../rpi_apendice3/" class="md-nav__link">
        Apéndices (III) - Administración con Webmin
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
      
      
      
        <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
          Acerca de
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Acerca de
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../about/about_acercademi/" class="md-nav__link">
        Acerca de mi y mis pruebas de concepto
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../about/about_privacy-policy/" class="md-nav__link">
        Política de privacidad
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#xbmc-con-mariadb-para-instalacion-distribuida" class="md-nav__link">
    XBMC con MariaDB para instalación distribuida
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>Apéndices (II) - XBMC con MariaDB para BBDD distribuida</h1>

<h2 id="xbmc-con-mariadb-para-instalacion-distribuida">XBMC con MariaDB para instalación distribuida<a class="headerlink" href="#xbmc-con-mariadb-para-instalacion-distribuida" title="Permanent link">&para;</a></h2>
<p>Como imagino que no seré el único que se encuentra tarde o temprano desplazado del televisor del salón, os cuento la forma de adaptar vuestros XBMC para que se puedan seguir usando tanto los ficheros de media de vuestros discos duros conectados a la Pi, como la base de datos de contenidos para las marcas de capítulos vistos, punto de reproducción etc.</p>
<p>En principio está todo bastante basado en una guía que publico Arthurbetico en NasyMas, adaptándolo a mi uso y necesidades por que claro, yo no tengo NAS.</p>
<p>Evalúa de todas maneras si esto que he hecho te sirve para algo, yo ahora mismo tengo la versión Frodo 12.3, la versión Gotham 13 está a pocas semanas de salir y anuncian cambios en todo esto de la "compartición" de contenidos, lo mismo luego es mucho más fácil… o no…</p>
<p>De lo que se trata es de instalar un motor de base de datos (MariaDB), configurar XBMC para que use este motor, y además crear los "Scrapers" de una forma determinada para que todo se comporte igual estemos ejecutando XBMC en nuestra Rpi o en nuestro iMac/MacBook o Pc con Windows (arggg).</p>
<p>Debemos tener en cuenta que todos los "clientes" de XBMC que empleemos deberán ser la misma versión, esto es, o todos con Frodo 12.3 o ninguno...</p>
<p>Una implicación que tiene esto es que vais a perder toda la información de vuestra base de datos de XMBC, marcadores de visto/no visto, etc.</p>
<p>He probado las opciones de exportación/importanción de datos pero no he sido capaz de hacerlo funcionar, por otro lado el cambio que os voy a comentar a continuación en los scrapers no es compatible con los datos que tendríais en esas bases de datos actuales basadas en ficheros de texto y nos exigiría realizar tareas de actualización de datos en la base de datos MariaDB a manita… yo ya me he visto en estas cosas miles de veces por trabajo, pero a alguno se le puede fundir el "fusible" así que mejor esto otro…</p>
<p>Por partes entonces, lo primero parar xbmc si lo tenemos funcionando.
<div class="highlight"><pre><span></span><code>[root@Jarvis ~]# systemctl stop xbmc
</code></pre></div>
Ahora instalamos MariaDB
<div class="highlight"><pre><span></span><code>[root@Jarvis ~]# pacman -S mariadb

resolving dependencies...
looking for inter-conflicts...
Packages (1): mariadb-5.5.36-1
Total Download Size: 8.90 MiB
Total Installed Size: 88.27 MiB
:: Proceed with installation? [Y/n] Y
:: Retrieving packages ...
mariadb-5.5.36-1-armv6h 8.9 MiB 2.80M/s 00:03 [##########################################] 100%
(1/1) checking keys in keyring                [##########################################] 100%
(1/1) checking package integrity              [##########################################] 100%
(1/1) loading package files                   [##########################################] 100%
(1/1) checking for file conflicts             [##########################################] 100%
(1/1) checking available disk space           [##########################################] 100%
(1/1) installing mariadb                      [##########################################] 100%

&gt;&gt; If you are migrating from MySQL, don&#39;t forget to run &#39;mysql_upgrade&#39;
after mysqld.service restart.
synchronizing filesystem...
</code></pre></div>
Arrancamos MariaDB y la configuramos:
<div class="highlight"><pre><span></span><code>[root@Jarvis lib]# systemctl start mysqld

[root@Jarvis lib]# systemctl enable mysqld
ln -s &#39;/usr/lib/systemd/system/mysqld.service&#39; &#39;/etc/systemd/system/multi-user.target.wants/mysqld.service&#39;

[root@Jarvis lib]# mysql_secure_installation
/usr/bin/mysql_secure_installation: line 379: find_mysql_client: command not found
NOTE: RUNNING ALL PARTS OF THIS SCRIPT IS RECOMMENDED FOR ALL MariaDB
SERVERS IN PRODUCTION USE! PLEASE READ EACH STEP CAREFULLY!
In order to log into MariaDB to secure it, we&#39;ll need the current
password for the root user. If you&#39;ve just installed MariaDB, and
you haven&#39;t set the root password yet, the password will be blank,
so you should just press enter here.

Enter current password for root (enter for none):
OK, successfully used password, moving on...

Setting the root password ensures that nobody can log into the MariaDB
root user without the proper authorisation.

Set root password? [Y/n] Y
New password:
Re-enter new password:
Password updated successfully!

Reloading privilege tables..
... Success!

By default, a MariaDB installation has an anonymous user, allowing anyone
to log into MariaDB without having to have a user account created for
them. This is intended only for testing, and to make the installation
go a bit smoother. You should remove them before moving into a
production environment.

Remove anonymous users? [Y/n] Y
... Success!

Normally, root should only be allowed to connect from &#39;localhost&#39;. This
ensures that someone cannot guess at the root password from the network.
Disallow root login remotely? [Y/n] Y
... Success!

By default, MariaDB comes with a database named &#39;test&#39; that anyone can
access. This is also intended only for testing, and should be removed
before moving into a production environment.
Remove test database and access to it? [Y/n] Y

- Dropping test database...
... Success!

- Removing privileges on test database...
... Success!

Reloading the privilege tables will ensure that all changes made so far
will take effect immediately.

Reload privilege tables now? [Y/n] Y
... Success!

Cleaning up...

All done! If you&#39;ve completed all of the above steps, your MariaDB
installation should now be secure.

Thanks for using MariaDB!
</code></pre></div></p>
<p>Bien, ahora vamos a crear un usuario dentro de nuestro gestor de base de datos, con privilegios para crear su propia base de datos.</p>
<p>Recordar que la contraseña del usuario root que hemos puesto hace un momento al configurar MariaDB (ó Mysql) es la del usuario <code>root</code> <strong>de la base de datos, no del sistema operativo!!</strong>.
<div class="highlight"><pre><span></span><code>[root@Jarvis ~]# mysql -u root -p

Enter password:
Welcome to the MariaDB monitor. Commands end with ; or \\g.
Your MariaDB connection id is 141
Server version: 5.5.37-MariaDB-log MariaDB Server
Copyright (c) 2000, 2014, Oracle, Monty Program Ab and others.
Type &#39;help;&#39; or &#39;\\h&#39; for help. Type &#39;\\c&#39; to clear the current input statement.
MariaDB [(none)]&gt; create user &#39;xbmc&#39; identified by &#39;xbmc&#39;;
MariaDB [(none)]&gt; grant all on *.* to &#39;xbmc&#39;;
MariaDB [(none)]&gt; flush privileges;
MariaDB [(none)]&gt; exit
Bye
</code></pre></div></p>
<p>Siguiente paso, configurar XBMC para que utilice esa base de datos.</p>
<p>El fichero de configuración será el mismo que empleemos luego en nuestros clientes xbmc en el entorno MAC.</p>
<p>Debemos ejecutar la siguiente cadena de comandos:
<div class="highlight"><pre><span></span><code>[root@Jarvis ~]# vi ~xbmc/.xbmc/userdata/advancedsettings.xml

Introducir este contenido y salvar documento.

&lt;advancedsettings&gt;
 &lt;videodatabase&gt;
  &lt;type&gt;mysql&lt;/type&gt;
  &lt;host&gt;192.168.1.20&lt;/host&gt;
  &lt;name&gt;xbmc_video&lt;/name&gt;
  &lt;port&gt;3306&lt;/port&gt;
  &lt;user&gt;xbmc&lt;/user&gt;
  &lt;pass&gt;xbmc&lt;/pass&gt;
 &lt;/videodatabase&gt;
 &lt;musicdatabase&gt;
  &lt;type&gt;mysql&lt;/type&gt;
  &lt;host&gt;192.168.1.20&lt;/host&gt;
  &lt;name&gt;xbmc_music&lt;/name&gt;
  &lt;port&gt;3306&lt;/port&gt;
  &lt;user&gt;xbmc&lt;/user&gt;
  &lt;pass&gt;xbmc&lt;/pass&gt;
 &lt;/musicdatabase&gt;
&lt;/advancedsettings&gt;
</code></pre></div></p>
<p>Importante, cambiad la IP de vuestra máquina en vuestra LAN.</p>
<p>Como hemos editado con root, le damos el fichero al usuario xbmc:
<div class="highlight"><pre><span></span><code>[root@Jarvis ~]# chown xbmc:xbmc ~xbmc/.xbmc/userdata/advancedsettings.xml
</code></pre></div></p>
<p>Y ahora, por último antes de arrancar y empezar a configurar scrapers en XBMC nos faltan dos tareas, la primera es exportar nuestra biblioteca de medios por SAMBA.</p>
<p>¿Por que?, pues porqué así el resto de equipos de la red van a ver los ficheros compartidos, es más, nuestra propia RPi va a acceder a sus propios ficheros de media por SAMBA, si, el local accediendo por SAMBA, por que así es la única manera de mantener un acceso único y uniforme al fichero, todos accediendo por igual.</p>
<p>Sin más líos, SAMBA <a href="http://pruebadeconcepto.es/instalando-una-raspberrypi-todo-uso-en-2014/instalando-una-raspberrypi-todo-uso-en-2014-parte-8-practico-2-gestor-de-descargas/">ya hemos visto como ponerlo en marcha</a>, basta con decir que tenemos que exportar esto:</p>
<div class="highlight"><pre><span></span><code>[root@Jarvis ~]# vi /etc/samba/smb.conf
[global]
workgroup = JarvisGRP
security = user
load printers = no

[Videos]
path = Videos
public = no
writable = yes
browseable = yes
valid users = root
</code></pre></div>
<p>Yo tengo colgando de <code>/Videos</code> las carpetas <code>/Videos/Series</code> , <code>/Videos/Pelis</code> y <code>/Videos/Documentales</code> .</p>
<p>Así que el acceso por SAMBA <a href="smb://192.168.1.20/Videos">smb://192.168.1.20/Videos</a> será nuestro punto de entrada al sistema de medios.</p>
<p>Podéis incluso probar que funciona, desde vuestros OSX, abriendo un nuevo finder (CMD + N) y pulsado sobre conectar a servidor (CMD +K) con ese <a href="smb://vuestraIP/vuestroShare">smb://vuestraIP/vuestroShare</a> podréis acceder a la Rpi por SAMBA.</p>
<p>Recordad activar samba en el inicio con
<div class="highlight"><pre><span></span><code>[root@Jarvis ~]# systemctl restart smbd nmbd
[root@Jarvis ~]# systemctl enable smbd nmbd
</code></pre></div></p>
<p>La otra tarea que hace falta hacer es el arranque de MariaDB, ahora está puesto en automático que arranque siempre cuando se inicie el sistema, pero siendo un proceso algo pesado, pues quizás nos sea más conveniente que se inicie siempre solo cuando XMBC esté activado también para arrancar ¿no?, total, van a ir de la mano.</p>
<p>Para esto que parece que es mucho y no es nada, editamos el fichero <code>/usr/lib/systemd/system/xbmc.service</code> para añadir en After y Requires el servicio de base de datos:</p>
<p><div class="highlight"><pre><span></span><code>[Unit]

Description = Starts instance of XBMC using xinit
After = remote-fs.target mysqld.service
Requires = mysqld.service
</code></pre></div>
Y en el fichero <code>/usr/lib/systemd/system/mysqld.service</code> añadir esto en Before:
<div class="highlight"><pre><span></span><code>[Unit]

Description=MariaDB database server
After=syslog.target
Before = xbmc.service
</code></pre></div></p>
<p>Si tenemos los servicios de xbmc y mysqld ya activos en el inicio debemos refrescar esos demonios, ejecutando esto:
<div class="highlight"><pre><span></span><code>[root@Jarvis system]# systemctl daemon-reload
</code></pre></div></p>
<p>Y listo, vamos a empezar, arrancamos XBMC, se nos arrancará la base de datos, bien, sin problemas.</p>
<p>Ahora BORRAMOS los scrapers y todo lo que tuviésemos de antes (ojo borrar datos, no ficheros) y volvemos a empezar a crear de nuevo.</p>
<p>Cuando entremos a crear los scrapers de nuevo, en la ventana en la que escogemos la ruta debemos desplazarnos hasta que encontremos una que nos indica acceso por Samba o por SMB, esa es la nuestra, tan sólo seguir los pasos de la pantalla, poner usuarios y claves donde nos lo pida y listo.</p>
<p>No es muy complicado y ya lo hemos hecho una vez, a ver si puedo poner unas capturas de pantalla.</p>
<p>Al terminar todo habremos reconstruido nuestra base de datos pero utilizando una base de datos a la que podemos atacar desde el exterior, en nuestra LAN.</p>
<p>La parte de OSX, pues muy fácil, instalamos XBMC (misma versión que en la RPI, recordad) y generamos el fichero <code>advancedsettings.xml</code> tal y como tenemos en nuestra RPI, el mismo contenido.</p>
<p>Este fichero está en <code>/Users/TUUAURIO/Library/Application Support/XBMC/userdata</code> y si no existe lo debéis crear.</p>
<p>Cuando os arranque XBMC de vuestro OSX es crear los scrapers tal y como hemos hecho en la RPi (acceso único por samba. genial verdad?!!) y listo, ya veréis como las marcas de visto/no visto se sincronizan y los puntos de reproducción también.</p>
<p>Pendiente dejo lo de las capturas… que ando con lío.</p>





                
              </article>
            </div>
          
          
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2019-2023 Antonio Hernan
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.top"], "search": "../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.19047be9.min.js"></script>
      
    
  </body>
</html>